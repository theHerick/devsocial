<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevConsole - Social Network for Developers</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            color: #c9d1d9;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .console-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .console-header {
            border-bottom: 1px solid #30363d;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .console-title {
            color: #58a6ff;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .console-subtitle {
            color: #7d8590;
            font-size: 12px;
        }

        .console-output {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
            margin-bottom: 20px;
        }

        .console-input-container {
            display: flex;
            align-items: center;
            border-top: 1px solid #30363d;
            padding-top: 10px;
        }

        .console-prompt {
            color: #7c3aed;
            margin-right: 10px;
            font-weight: bold;
        }

        .console-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #c9d1d9;
            font-family: inherit;
            font-size: inherit;
            outline: none;
        }

        .output-line {
            margin-bottom: 8px;
            padding: 2px 0;
        }

        .output-error {
            color: #f85149;
        }

        .output-success {
            color: #56d364;
        }

        .output-info {
            color: #58a6ff;
        }

        .output-warning {
            color: #f0883e;
        }

        .auth-form {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 20px;
            max-width: 400px;
            margin: 20px auto;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            color: #f0f6fc;
            margin-bottom: 5px;
            font-size: 12px;
        }

        .form-input {
            width: 100%;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 4px;
            padding: 8px 10px;
            color: #c9d1d9;
            font-family: inherit;
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: #58a6ff;
        }

        .form-button {
            background: #238636;
            border: none;
            border-radius: 4px;
            color: white;
            padding: 8px 16px;
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            margin-right: 10px;
        }

        .form-button:hover {
            background: #2ea043;
        }

        .hidden {
            display: none;
        }

        /* Scrollbar styling */
        .console-output::-webkit-scrollbar {
            width: 8px;
        }

        .console-output::-webkit-scrollbar-track {
            background: #161b22;
        }

        .console-output::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 4px;
        }

        .console-output::-webkit-scrollbar-thumb:hover {
            background: #484f58;
        }
    </style>
</head>
<body>
    <div class="console-container">
        <div class="console-header">
            <div class="console-title">DevConsole v1.0.0</div>
            <div class="console-subtitle">Social Network for Developers</div>
        </div>

        <!-- Login/Register Section -->
        <div id="authSection" class="auth-form">
            <div id="loginForm">
                <h3 style="color: #58a6ff; margin-bottom: 20px; text-align: center;">Login</h3>
                <form id="loginFormElement">
                    <div class="form-group">
                        <label class="form-label" for="loginEmail">Email:</label>
                        <input type="email" class="form-input" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="loginPassword">Password:</label>
                        <input type="password" class="form-input" id="loginPassword" required>
                    </div>
                    <button type="submit" class="form-button">Login</button>
                    <button type="button" class="form-button" onclick="showRegisterForm()">Create Account</button>
                </form>
            </div>

            <div id="registerForm" class="hidden">
                <h3 style="color: #58a6ff; margin-bottom: 20px; text-align: center;">Register</h3>
                <form id="registerFormElement">
                    <div class="form-group">
                        <label class="form-label" for="regEmail">Email:</label>
                        <input type="email" class="form-input" id="regEmail" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="regPassword">Password:</label>
                        <input type="password" class="form-input" id="regPassword" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="regUsername">Username:</label>
                        <input type="text" class="form-input" id="regUsername" required>
                    </div>
                    <button type="submit" class="form-button">Register</button>
                    <button type="button" class="form-button" onclick="showLoginForm()">Back to Login</button>
                </form>
            </div>
        </div>

        <!-- Main App Section (hidden initially) -->
        <div id="mainApp" class="hidden">
            <div class="console-output" id="output">
                <div class="output-line output-success">Welcome to DevConsole! You are now logged in.</div>
            </div>

            <div class="console-input-container">
                <span class="console-prompt" id="prompt">user@devconsole:~$</span>
                <input type="text" class="console-input" id="commandInput" placeholder="Type a command..." autocomplete="off">
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase configuration (same as PokePoint)
        const firebaseConfig = {
            apiKey: "AIzaSyAexCf7hPN2OQvfsw66UDpci6nycivrK98",
            authDomain: "void-activation-system.firebaseapp.com",
            databaseURL: "https://void-activation-system-default-rtdb.firebaseio.com",
            projectId: "void-activation-system",
            storageBucket: "void-activation-system.firebasestorage.app",
            messagingSenderId: "108268095097",
            appId: "1:108268095097:web:4f45ff75a9e528b3f0f6a8",
            measurementId: "G-P71BZFRDQB"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Global variables
        let currentUser = null;

        // Collection names
        const USERS_COLLECTION = 'devsocial-users';
        const POSTS_COLLECTION = 'devsocial-posts';

        // UI Functions
        function showLoginForm() {
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }

        function showRegisterForm() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
        }

        function showMainApp() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            updatePrompt();
            loadPosts();
        }

        function showAuthSection() {
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('authSection').classList.remove('hidden');
        }

        function updatePrompt() {
            const prompt = document.getElementById('prompt');
            if (currentUser) {
                prompt.textContent = `${currentUser.displayName || currentUser.email}@devconsole:~$`;
            } else {
                prompt.textContent = 'guest@devconsole:~$';
            }
        }

        // Authentication
        auth.onAuthStateChanged(user => {
            currentUser = user;
            if (user) {
                console.log('User logged in:', user.email);
                showMainApp();
            } else {
                console.log('User logged out');
                showAuthSection();
            }
        });

        // Login Form Handler
        document.getElementById('loginFormElement').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const submitBtn = this.querySelector('button[type="submit"]');
            submitBtn.textContent = 'Logging in...';
            submitBtn.disabled = true;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    addOutput('✅ Login successful!', 'success');
                    this.reset();
                })
                .catch((error) => {
                    console.error('Login error:', error);
                    addOutput(`❌ Login failed: ${error.message}`, 'error');
                })
                .finally(() => {
                    submitBtn.textContent = 'Login';
                    submitBtn.disabled = false;
                });
        });

        // Register Form Handler
        document.getElementById('registerFormElement').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const username = document.getElementById('regUsername').value;
            
            if (username.length < 2) {
                alert('Username must be at least 2 characters long.');
                return;
            }
            
            const submitBtn = this.querySelector('button[type="submit"]');
            submitBtn.textContent = 'Creating account...';
            submitBtn.disabled = true;
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    
                    // Update user profile with username
                    return user.updateProfile({
                        displayName: username
                    }).then(() => {
                        // Create user document in Firestore
                        return db.collection(USERS_COLLECTION).doc(user.uid).set({
                            username: username,
                            email: email,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                            postCount: 0
                        });
                    });
                })
                .then(() => {
                    alert('Account created successfully!');
                    this.reset();
                    showLoginForm();
                })
                .catch((error) => {
                    console.error('Registration error:', error);
                    alert(`Registration failed: ${error.message}`);
                })
                .finally(() => {
                    submitBtn.textContent = 'Register';
                    submitBtn.disabled = false;
                });
        });

        // Output functions
        function addOutput(text, type = '') {
            const output = document.getElementById('output');
            if (!output) return;
            
            const line = document.createElement('div');
            line.className = `output-line ${type ? 'output-' + type : ''}`;
            line.textContent = text;
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
        }

        // Command system
        const commandInput = document.getElementById('commandInput');
        
        if (commandInput) {
            commandInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const command = this.value.trim();
                    if (command) {
                        handleCommand(command);
                        this.value = '';
                    }
                }
            });
        }

        function handleCommand(command) {
            addOutput(`${document.getElementById('prompt').textContent} ${command}`);
            
            const [cmd, ...args] = command.split(' ');
            
            switch (cmd) {
                case 'help':
                    showHelp();
                    break;
                case 'logout':
                    logout();
                    break;
                case 'post':
                    if (args.length === 0) {
                        addOutput('❌ Usage: post <message>', 'error');
                    } else {
                        createPost(args.join(' '));
                    }
                    break;
                case 'posts':
                    loadPosts();
                    break;
                case 'clear':
                    clearOutput();
                    break;
                default:
                    addOutput(`❌ Unknown command: ${cmd}. Type 'help' for available commands.`, 'error');
            }
        }

        function showHelp() {
            addOutput('Available commands:', 'info');
            addOutput('  help - Show this help message');
            addOutput('  post <message> - Create a new post');
            addOutput('  posts - Load recent posts');
            addOutput('  logout - Logout from the system');
            addOutput('  clear - Clear the console');
        }

        function logout() {
            auth.signOut().then(() => {
                addOutput('👋 Logged out successfully!', 'success');
                clearOutput();
            });
        }

        function clearOutput() {
            const output = document.getElementById('output');
            if (output) {
                output.innerHTML = '';
            }
        }

        // Posts functions
        async function createPost(content) {
            if (!currentUser) {
                addOutput('❌ You must be logged in to post.', 'error');
                return;
            }
            
            try {
                await db.collection(POSTS_COLLECTION).add({
                    content: content,
                    author: currentUser.displayName || currentUser.email,
                    authorId: currentUser.uid,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    likes: 0,
                    comments: []
                });
                
                // Update user's post count
                await db.collection(USERS_COLLECTION).doc(currentUser.uid).update({
                    postCount: firebase.firestore.FieldValue.increment(1)
                });
                
                addOutput('✅ Post created successfully!', 'success');
                loadPosts();
            } catch (error) {
                console.error('Error creating post:', error);
                addOutput('❌ Failed to create post.', 'error');
            }
        }

        async function loadPosts() {
            try {
                const postsSnapshot = await db.collection(POSTS_COLLECTION)
                    .orderBy('timestamp', 'desc')
                    .limit(10)
                    .get();
                
                if (postsSnapshot.empty) {
                    addOutput('📝 No posts yet. Be the first to post!', 'info');
                    return;
                }
                
                addOutput('📄 Recent Posts:', 'info');
                postsSnapshot.forEach(doc => {
                    const post = doc.data();
                    const timestamp = post.timestamp ? post.timestamp.toDate().toLocaleString() : 'Just now';
                    addOutput(`👤 ${post.author} (${timestamp})`);
                    addOutput(`   ${post.content}`);
                    addOutput(`   ❤️ ${post.likes} likes | 💬 ${post.comments?.length || 0} comments`);
                    addOutput('');
                });
            } catch (error) {
                console.error('Error loading posts:', error);
                addOutput('❌ Failed to load posts.', 'error');
            }
        }

        // Initialize app
        function initializeApp() {
            addOutput('🚀 DevConsole initialized!', 'success');
        }

        // Start app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>
